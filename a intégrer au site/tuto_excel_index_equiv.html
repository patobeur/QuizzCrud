<!doctype html>
<html lang="fr" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Excel ‚Äî INDEX, EQUIV, INDEX+EQUIV (Cours complet)</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind dark mode setup
    tailwind.config = { darkMode: 'class' };
  </script>
  <style>
    .fade-in{opacity:0;transform:translateY(8px);transition:all .5s ease}
    .fade-in.visible{opacity:1;transform:translateY(0)}
    .code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .toc a{display:block;padding:.25rem .5rem;border-radius:.5rem}
    .toc a.active{background:rgb(59 130 246 / .12);color:rgb(37 99 235)}
    /* Onglets fixes sous le header */
    
    
     /* espace r√©serv√© sous la barre fixe */
  </style>
</head>
<body class="h-full bg-slate-50 text-slate-800 dark:bg-slate-950 dark:text-slate-100">
  <header class="sticky top-0 z-30 bg-white/80 dark:bg-slate-900/80 backdrop-blur border-b border-slate-200 dark:border-slate-800">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-end gap-2">
      <button id="themeToggle" class="px-3 py-1 rounded-md border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800 text-sm" aria-label="Basculer th√®me">üåô/‚òÄÔ∏è</button>
    </div>
  </header>

  <!-- Titre principal en dehors du header -->
  <div class="max-w-6xl mx-auto px-4 mt-6">
    <h1 class="text-2xl sm:text-3xl font-bold tracking-tight mb-4">EXCEL ‚Äî <span class="text-blue-600 dark:text-blue-400">INDEX</span>, <span class="text-blue-600 dark:text-blue-400">EQUIV</span>, <span class="text-blue-600 dark:text-blue-400">INDEX+EQUIV</span></h1>
  </div>

  <!-- Onglets SOUS LE TITRE (non fixes) -->
  <div class="max-w-6xl mx-auto px-4 mt-2">
    <div class="inline-flex w-full overflow-x-auto rounded-xl border border-slate-200 dark:border-slate-800 bg-white/90 dark:bg-slate-900/90 backdrop-blur p-1 shadow-sm gap-1">
      <button data-tab="tab-index" class="tab-btn px-4 py-2 rounded-lg text-sm font-semibold bg-blue-600 text-white whitespace-nowrap">Feuille INDEX</button>
      <button data-tab="tab-equiv" class="tab-btn px-4 py-2 rounded-lg text-sm font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 whitespace-nowrap">Feuille EQUIV</button>
      <button data-tab="tab-index-equiv" class="tab-btn px-4 py-2 rounded-lg text-sm font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 whitespace-nowrap">Feuille INDEX+EQUIV</button>
    </div>
  </div>

  <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-[260px,1fr] gap-6 px-4 py-6">
    <!-- TOC Sidebar -->
    <aside class="lg:block bg-white/70 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-2xl p-4 h-max sticky top-20 hidden" id="toc">
      <h2 class="text-sm font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400 mb-2">Sommaire</h2>
      <nav class="toc text-sm space-y-1" id="tocLinks"></nav>
      <div class="mt-4 flex flex-col gap-2">
        <a href="#" class="px-3 py-2 text-center rounded-md border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800 text-sm">T√©l√©charger exercices (Excel)</a>
        <a href="#" class="px-3 py-2 text-center rounded-md border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800 text-sm">T√©l√©charger poly (PDF)</a>
      </div>
    </aside>

    <!-- Main -->
    <main id="content" class="space-y-8">
      <!-- TAB: INDEX -->
      <section id="tab-index" class="tab-panel space-y-6" data-anchor-title="Feuille INDEX">
        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="index-intro">
          <h2 class="text-lg font-bold">1) Mise en situation</h2>
          <p class="mt-2">Imagine un <strong>tableau √† double entr√©e</strong> : en lignes, des <strong>produits</strong> (A2:A6) ; en colonnes, des <strong>trimestres</strong> T1‚ÄìT3 (B1:D1). On veut pouvoir <strong>pointer n‚Äôimporte quelle case</strong> sans la souris, uniquement avec ses coordonn√©es (ligne/colonne). C‚Äôest exactement ce que fait <strong>INDEX</strong> : on lui donne une <em>matrice</em>, un <em>num√©ro de ligne</em> et, si besoin, un <em>num√©ro de colonne</em>, et il renvoie la <strong>valeur</strong>.</p>
          <!-- Image placeholder -->
          <figure class="mt-4">
            <img src="img/000001.png" alt="Capture tableau Produits x T1..T3" class="w-sm rounded-xl border border-slate-200 dark:border-slate-800" />
            <figcaption class="text-xs text-slate-500 dark:text-slate-400 mt-1">(Capture) Tableau Produits √ó Trimestres.</figcaption>
          </figure>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="index-prereq">
          <button class="acc-btn w-full text-left"><h3 class="text-lg font-bold flex items-center justify-between">2) Ce qu‚Äôil faut comprendre avant de taper la moindre formule <span class="chev text-slate-400">‚ñæ</span></h3></button>
          <div class="acc-panel mt-3 space-y-2">
            <p><strong>La matrice</strong> (ou plage) n‚Äôest pas toute la feuille, mais <strong>le rectangle choisi</strong>. Ici : <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">B2:D6</code>.</p>
            <p>Les <strong>num√©ros de ligne/colonne sont relatifs √† la matrice</strong>. Dans <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">B2:D6</code> : ligne 1 = ligne 2 de la feuille (Produit A) ; colonne 1 = colonne B (T1).</p>
            <p>Si la matrice est <strong>une seule colonne</strong>, on n‚Äôindique pas de colonne dans INDEX.</p>
            <!-- Diagram placeholder -->
            <figure class="mt-3">
              <img src="img/000002.png" alt="Diagramme indices dans la matrice" class="w-sm rounded-xl border border-slate-200 dark:border-slate-800" />
              <figcaption class="text-xs text-slate-500 dark:text-slate-400 mt-1">(Diagramme) Num√©rotation relative des lignes/colonnes dans la matrice.</figcaption>
            </figure>
          </div>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="index-formula">
          <button class="acc-btn w-full text-left"><h3 class="text-lg font-bold flex items-center justify-between">3) La formule, expliqu√©e <span class="chev text-slate-400">‚ñæ</span></h3></button>
          <div class="acc-panel mt-3 space-y-3">
            <div>
              <div class="text-sm uppercase tracking-wide text-slate-500 dark:text-slate-400 font-semibold mb-1">Syntaxe (FR)</div>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=INDEX(matrice; no_ligne; [no_colonne])</pre>
            </div>
            <ul class="list-disc pl-5">
              <li><strong>matrice</strong> : ex. <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">B2:D6</code></li>
              <li><strong>no_ligne</strong> : position dans la matrice (1, 2, 3‚Ä¶)</li>
              <li><strong>no_colonne</strong> : position de la colonne (optionnel si une seule colonne)</li>
            </ul>
          </div>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="index-demos">
          <h3 class="text-lg font-bold mb-3">4) D√©monstration guid√©e</h3>
          <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4 mb-3 open:bg-slate-50 dark:open:bg-slate-900/40">
            <summary class="cursor-pointer font-semibold">Exercice 1 ‚Äî Atteindre une case par coordonn√©es</summary>
            <div class="mt-2 space-y-2">
              <p><strong>Objectif</strong> : valeur <strong>ligne 3, colonne 2</strong> dans <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">B2:D6</code> (√©crire en <strong>G3</strong>).</p>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=INDEX(B2:D6; 3; 2)</pre>
              <p><strong>R√©sultat</strong> : <code class="code">160</code></p>
            </div>
          </details>
          <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4 mb-3">
            <summary class="cursor-pointer font-semibold">Exercice 2 ‚Äî Index sur une colonne simple</summary>
            <div class="mt-2 space-y-2">
              <p><strong>Objectif</strong> : renvoyer la <strong>5·µâ</strong> valeur de <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">D2:D6</code> (√©crire en <strong>G6</strong>).</p>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=INDEX(D2:D6; 5)</pre>
              <p><strong>R√©sultat</strong> : <code class="code">120</code></p>
            </div>
          </details>
          <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4">
            <summary class="cursor-pointer font-semibold">Exercice 3 ‚Äî INDEX qui renvoie toute une ligne</summary>
            <div class="mt-2 space-y-2">
              <p><strong>Objectif</strong> : renvoyer <strong>toute la ligne 2</strong> de <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">B2:D6</code> et l‚Äô<strong>afficher en B9:D9</strong>.</p>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=INDEX($B$2:$D$6; 2; )</pre>
              <p><strong>R√©sultat</strong> : <code class="code">85 | 95 | 100</code> (selon version, Ctrl+Maj+Entr√©e)</p>
            </div>
          </details>
        </article>
      </section>

      <!-- TAB: EQUIV -->
      <section id="tab-equiv" class="tab-panel hidden space-y-6" data-anchor-title="Feuille EQUIV">
        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="equiv-intro">
          <h2 class="text-lg font-bold">1) Mise en situation</h2>
          <p class="mt-2">On dispose de listes et de tables (noms, codes, seuils‚Ä¶). <strong>EQUIV</strong> sert √† retrouver la <strong>POSITION</strong> d‚Äôun √©l√©ment dans une <strong>plage</strong> (1, 2, 3, ‚Ä¶). Ensuite on combine avec <strong>INDEX</strong> pour renvoyer la valeur associ√©e.</p>
          <figure class="mt-4">
            <img src="img/000003.png" alt="Capture liste Fruits et Seuils" class="w-sm rounded-xl border border-slate-200 dark:border-slate-800" />
            <figcaption class="text-xs text-slate-500 dark:text-slate-400 mt-1">(Capture) Liste des fruits & seuils de remise.</figcaption>
          </figure>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="equiv-prereq">
          <button class="acc-btn w-full text-left"><h3 class="text-lg font-bold flex items-center justify-between">2) Ce qu‚Äôil faut comprendre avant de taper la moindre formule <span class="chev text-slate-400">‚ñæ</span></h3></button>
          <div class="acc-panel mt-3 space-y-2">
            <p><strong>EQUIV</strong> renvoie une <strong>position</strong>, pas une valeur.</p>
            <p>Le 3·µâ argument (<em>type</em>) contr√¥le la recherche : <strong>0</strong> exacte, <strong>1</strong> approximative <em>croissante</em>, <strong>-1</strong> approximative <em>d√©croissante</em>.</p>
            <p>Pour <strong>1</strong> et <strong>-1</strong>, la plage doit √™tre <strong>tri√©e</strong> dans le bon sens.</p>
          </div>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="equiv-formula">
          <button class="acc-btn w-full text-left"><h3 class="text-lg font-bold flex items-center justify-between">3) La formule, expliqu√©e <span class="chev text-slate-400">‚ñæ</span></h3></button>
          <div class="acc-panel mt-3 space-y-3">
            <div>
              <div class="text-sm uppercase tracking-wide text-slate-500 dark:text-slate-400 font-semibold mb-1">Syntaxe (FR)</div>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=EQUIV(valeur_cherch√©e; plage_recherche; [type])</pre>
            </div>
            <ul class="list-disc pl-5">
              <li><strong>0</strong> : exact (plage non tri√©e OK)</li>
              <li><strong>1</strong> : approx. (plage tri√©e <em>croissante</em>) ‚Üí plus grande valeur ‚â§ la valeur cherch√©e</li>
              <li><strong>-1</strong> : approx. (plage tri√©e <em>d√©croissante</em>) ‚Üí plus petite valeur ‚â• la valeur cherch√©e</li>
            </ul>
          </div>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="equiv-demos">
          <h3 class="text-lg font-bold mb-3">4) D√©monstration guid√©e</h3>
          <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4 mb-3 open:bg-slate-50 dark:open:bg-slate-900/40">
            <summary class="cursor-pointer font-semibold">Exercice 1 ‚Äî Recherche exacte (type = 0)</summary>
            <div class="mt-2 space-y-2">
              <p><strong>Objectif</strong> : position de <strong>"Cerise"</strong> dans <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">A2:A7</code> (√©crire en <strong>E3</strong>).</p>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=EQUIV("Cerise"; A2:A7; 0)</pre>
              <p><strong>R√©sultat</strong> : <code class="code">3</code></p>
            </div>
          </details>
          <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4 mb-3">
            <summary class="cursor-pointer font-semibold">Exercice 2 ‚Äî Approximative croissante (type = 1)</summary>
            <div class="mt-2 space-y-2">
              <p><strong>Objectif</strong> : pour <strong>43 unit√©s</strong>, position dans les <strong>seuils croissants</strong> <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">A10:A13</code> (=10, 20, 50, 100) ‚Äî √©crire en <strong>E10</strong>.</p>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=EQUIV(43; A10:A13; 1)</pre>
              <p><strong>R√©sultat</strong> : <code class="code">2</code> (plus grande valeur ‚â§ 43 = 20, 2·µâ position)</p>
              <p><strong>Remise (%) associ√©e</strong> :</p>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=INDEX(B10:B13; EQUIV(43; A10:A13; 1))</pre>
              <p><strong>R√©sultat</strong> : <code class="code">8%</code></p>
            </div>
          </details>
          <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4">
            <summary class="cursor-pointer font-semibold">Exercice 3 ‚Äî Approximative d√©croissante (type = -1)</summary>
            <div class="mt-2 space-y-2">
              <p><strong>Objectif</strong> : sur la liste <strong>d√©croissante</strong> <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">M9:M12</code> (=100, 50, 20, 10), position pour <strong>43</strong> (√©crire en <strong>E12</strong>).</p>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=EQUIV(43; M9:M12; -1)</pre>
              <p><strong>R√©sultat</strong> : <code class="code">2</code> (plus petite valeur ‚â• 43 = 50, 2·µâ position)</p>
            </div>
          </details>
        </article>
      </section>

      <!-- TAB: INDEX + EQUIV -->
      <section id="tab-index-equiv" class="tab-panel hidden space-y-6" data-anchor-title="Feuille INDEX+EQUIV">
        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="combo-intro">
          <h2 class="text-lg font-bold">1) Mise en situation</h2>
          <p class="mt-2">On veut des recherches <strong>flexibles</strong> : par <strong>nom de produit</strong>, par <strong>code</strong>, ou √† l‚Äô<strong>intersection</strong> d‚Äôun <strong>commercial</strong> et d‚Äôun <strong>trimestre</strong>. <strong>EQUIV</strong> trouve la <strong>position</strong>, <strong>INDEX</strong> renvoie la <strong>valeur</strong>.</p>
          <figure class="mt-4">
            <img src="img/000004.png" alt="Capture liste de prix et matrice commerciale" class="w-sm rounded-xl border border-slate-200 dark:border-slate-800" />
            <figcaption class="text-xs text-slate-500 dark:text-slate-400 mt-1">(Capture) Liste de prix & matrice commerciale.</figcaption>
          </figure>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="combo-prereq">
          <button class="acc-btn w-full text-left"><h3 class="text-lg font-bold flex items-center justify-between">2) Ce qu‚Äôil faut comprendre avant de taper la moindre formule <span class="chev text-slate-400">‚ñæ</span></h3></button>
          <div class="acc-panel mt-3 space-y-2">
            <p>On combine <strong>EQUIV (o√π ?)</strong> et <strong>INDEX (quoi ?)</strong>.</p>
            <p>Les plages <em>recherche</em> et <em>retour</em> doivent correspondre (m√™me hauteur/largeur selon le cas).</p>
            <p>Encapsuler avec <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">SI</code>/<code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">ET</code> ou <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">SIERREUR</code> pour des messages propres.</p>
          </div>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="combo-combos">
          <button class="acc-btn w-full text-left"><h3 class="text-lg font-bold flex items-center justify-between">3) Les combinaisons, expliqu√©es simplement <span class="chev text-slate-400">‚ñæ</span></h3></button>
          <div class="acc-panel mt-3 space-y-3">
            <div>
              <div class="text-sm uppercase tracking-wide text-slate-500 dark:text-slate-400 font-semibold mb-1">Recherche simple (1 crit√®re)</div>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=INDEX(colonne_retour; EQUIV(valeur; colonne_crit√®re; 0))</pre>
            </div>
            <div>
              <div class="text-sm uppercase tracking-wide text-slate-500 dark:text-slate-400 font-semibold mb-1">Double entr√©e (ligne & colonne variables)</div>
              <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=INDEX(matrice; EQUIV(ligne; plage_lignes; 0); EQUIV(colonne; plage_colonnes; 0))</pre>
            </div>
          </div>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="combo-demos">
          <h3 class="text-lg font-bold mb-3">4) D√©monstration guid√©e (fid√®le aux corrections)</h3>
          <div class="border border-slate-200 dark:border-slate-800 rounded-xl p-4 mb-4">
            <h4 class="font-semibold mb-2">Partie A ‚Äî Liste de prix</h4>
            <p class="text-sm text-slate-600 dark:text-slate-400">Donn√©es : <strong>Code | Produit | Prix HT | Stock</strong> (lignes 2‚Üí6). Plages : Produits <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">B2:B6</code>, Prix HT <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">C2:C6</code>, Stock <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">D2:D6</code>, Codes <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">A2:A6</code>.</p>
            <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4 mt-3 open:bg-slate-50 dark:open:bg-slate-900/40">
              <summary class="cursor-pointer font-semibold">Exercice A.1 ‚Äî Par PRODUIT, renvoyer le PRIX HT</summary>
              <div class="mt-2 space-y-2">
                <p><strong>Objectif</strong> : saisir un <strong>Produit</strong> en <strong>H3</strong> (ex. <em>Webcam</em>), renvoyer le <strong>Prix HT</strong> en <strong>H4</strong>.</p>
                <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=SI(H3<>""; INDEX(C2:C6; EQUIV(H3; B2:B6; 0)); "produit vide")</pre>
                <p><strong>R√©sultat attendu</strong> (Webcam) : <code class="code">45,00 ‚Ç¨</code></p>
              </div>
            </details>
            <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4 mt-3">
              <summary class="cursor-pointer font-semibold">Exercice A.2 ‚Äî Par CODE, renvoyer le STOCK</summary>
              <div class="mt-2 space-y-2">
                <p><strong>Objectif</strong> : saisir un <strong>Code</strong> en <strong>H6</strong> (ex. <em>P-100</em>), renvoyer le <strong>Stock</strong> en <strong>H7</strong>.</p>
                <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=SI(H6<>""; INDEX(D2:D6; EQUIV(H6; A2:A6; 0)); "article vide")</pre>
                <p><strong>R√©sultat attendu</strong> (P-100) : <code class="code">120</code></p>
              </div>
            </details>
          </div>
          <div class="border border-slate-200 dark:border-slate-800 rounded-xl p-4">
            <h4 class="font-semibold mb-2">Partie B ‚Äî Recherche √† double entr√©e</h4>
            <p class="text-sm text-slate-600 dark:text-slate-400">Plages : Lignes (commerciaux) <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">A9:A12</code> ‚Äî Colonnes (T1..T4) <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">B8:E8</code> ‚Äî Matrice <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">B9:E12</code>.</p>
            <details class="group border border-slate-200 dark:border-slate-800 rounded-xl p-4 mt-3">
              <summary class="cursor-pointer font-semibold">Exercice B.3 ‚Äî Par COMMERCIAL & TRIMESTRE, renvoyer le MONTANT</summary>
              <div class="mt-2 space-y-2">
                <p><strong>Objectif</strong> : saisir un <strong>Commercial</strong> en <strong>H10</strong> (ex. <em>Carla</em>) et un <strong>Trimestre</strong> en <strong>I10</strong> (ex. <em>T3</em>), renvoyer le montant en <strong>H11</strong>.</p>
                <pre class="code bg-slate-900 text-slate-50 p-3 rounded-lg overflow-x-auto">=SI(ET(H10<>""; I10<>""); INDEX(B9:E12; EQUIV(H10; A9:A12; 0); EQUIV(I10; B8:E8; 0)); "")</pre>
                <p><strong>R√©sultat attendu</strong> (Carla & T3) : <code class="code">15 000,00 ‚Ç¨</code></p>
              </div>
            </details>
          </div>
        </article>

        <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm fade-in" id="combo-retain">
          <h3 class="text-lg font-bold mb-2">5) √Ä retenir</h3>
          <ul class="list-disc pl-5 space-y-1">
            <li><strong>EQUIV</strong> ‚áí <em>position</em> ; <strong>INDEX</strong> ‚áí <em>valeur</em>.</li>
            <li>M√™me logique quel que soit le crit√®re (nom, code, trimestre).</li>
            <li>Encapsuler avec <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">SI/ET</code> ou <code class="code bg-slate-100 dark:bg-slate-800 px-1 rounded">SIERREUR</code> pour g√©rer les vides/erreurs.</li>
          </ul>
        </article>
      </section>

      <!-- Barre de t√©l√©chargement (visible pour toutes les feuilles) -->
      <section id="download-section" class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm">
        <h2 class="text-lg font-bold mb-2">T√©l√©chargements</h2>
        <p class="text-sm text-slate-600 dark:text-slate-400 mb-3">Ces liens restent visibles quelle que soit la feuille (INDEX, EQUIV, INDEX+EQUIV).</p>
        <div class="flex flex-wrap gap-2">
          <a href="#" class="px-3 py-2 rounded-md border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800 text-sm">T√©l√©charger exercices (Excel)</a>
          <a href="#" class="px-3 py-2 rounded-md border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800 text-sm">T√©l√©charger poly (PDF)</a>
        </div>
      </section>
    </main>
  </div>

  <!-- Footer (simplifi√©, sans boutons) -->
  <footer class="mt-10 pb-10 text-center text-sm text-slate-500 dark:text-slate-400">
    <div class="max-w-6xl mx-auto px-4">
      <p>Remplace les <em>src="#"</em> des images et les liens d‚Äôexemple par tes URLs r√©elles.</p>
    </div>
  </footer>

  <script>
    // Theme toggle with persistence
    const root = document.documentElement;
    const themeToggle = document.getElementById('themeToggle');
    const stored = localStorage.getItem('theme');
    if (stored === 'dark' || (!stored && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      root.classList.add('dark');
    }
    themeToggle.addEventListener('click', () => {
      root.classList.toggle('dark');
      localStorage.setItem('theme', root.classList.contains('dark') ? 'dark' : 'light');
    });

    // Tabs
    const tabBtns = document.querySelectorAll('.tab-btn');
    const panels = document.querySelectorAll('.tab-panel');
    tabBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.getAttribute('data-tab');
        tabBtns.forEach(b => b.classList.remove('bg-blue-600','text-white'));
        btn.classList.add('bg-blue-600','text-white');
        panels.forEach(p => p.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
        document.getElementById(id).querySelectorAll('.fade-in').forEach(el => el.classList.add('visible'));
        buildTOC(); // refresh TOC for current tab
      });
    });

    // Accordions
    document.querySelectorAll('.acc-btn').forEach(btn => {
      const panel = btn.nextElementSibling;
      panel.classList.remove('hidden'); // default open
      btn.addEventListener('click', () => {
        panel.classList.toggle('hidden');
        btn.querySelector('.chev').textContent = panel.classList.contains('hidden') ? '‚ñ∏' : '‚ñæ';
      });
    });

    // Fade-in on scroll
    const obs = new IntersectionObserver((entries) => {
      entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
    }, { threshold: 0.12 });
    document.querySelectorAll('.fade-in').forEach(el => obs.observe(el));

    // Build anchors & TOC for the visible tab
    function slugify(text){
      return text.toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9\-]/g,'').replace(/\-+/g,'-').replace(/^-+|-+$/g,'');
    }
    function buildTOC(){
      const current = Array.from(document.querySelectorAll('.tab-panel')).find(p=>!p.classList.contains('hidden'));
      const links = document.getElementById('tocLinks');
      links.innerHTML = '';
      if(!current) return;
      const headings = current.querySelectorAll('h2, h3');
      headings.forEach(h => {
        if(!h.id){ h.id = slugify(h.textContent.trim()); }
        const a = document.createElement('a');
        a.href = `#${h.id}`;
        a.textContent = h.textContent.trim();
        a.className = h.tagName === 'H2' ? 'font-semibold' : 'ml-3';
        links.appendChild(a);
      });
      // highlight on scroll
      const observer = new IntersectionObserver((entries)=>{
        entries.forEach(entry=>{
          const id = entry.target.id;
          const el = links.querySelector(`a[href="#${CSS.escape(id)}"]`);
          if(!el) return;
          if(entry.isIntersecting){
            links.querySelectorAll('a').forEach(x=>x.classList.remove('active'));
            el.classList.add('active');
          }
        });
      }, {rootMargin: '-40% 0px -55% 0px'});
      headings.forEach(h=>observer.observe(h));
    }
    buildTOC();

    </script>

</body>
</html>
